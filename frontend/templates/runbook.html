{% extends "base.html" %}

{% block title %}Runbook - Daena VP{% endblock %}

{% block content %}
<div class="space-y-6">
    <div>
        <h1 class="text-2xl font-bold text-white">Runbook</h1>
        <p class="text-gray-400 text-sm mt-1">Suggested actions for troubleshooting failed tasks and execution issues</p>
    </div>

    <div class="glass-panel p-6 rounded-xl">
        <h2 class="text-lg font-medium text-white mb-4">When a task fails</h2>
        <ul class="list-disc list-inside text-gray-300 text-sm space-y-2">
            <li>Check <a href="/ui/control-pannel#execution" class="text-daena-gold hover:underline">Execution logs</a> (Control Plane → Execution) for the failing step (tool name, status, timestamp).</li>
            <li>On the <a href="/ui/control-pannel#tasks-runbook-approvals" class="text-daena-gold hover:underline">Tasks</a> (Control Plane → Tasks & Runbook & Approvals): re-run the task step (Run step) or create a new task with a narrower goal.</li>
            <li>Ensure Execution Token is set in App Setup / Dashboard and that the system is not in <a href="/ui/incident-room" class="text-daena-gold hover:underline">lockdown</a> (Incident Room).</li>
        </ul>
    </div>

    <div class="glass-panel p-6 rounded-xl">
        <h2 class="text-lg font-medium text-white mb-4">When execution is blocked</h2>
        <ul class="list-disc list-inside text-gray-300 text-sm space-y-2">
            <li>Verify <strong>X-Execution-Token</strong> is set (sessionStorage: <code class="bg-black/30 px-1 rounded text-gray-400">daena_execution_token</code>) and matches the server <code class="bg-black/30 px-1 rounded text-gray-400">EXECUTION_TOKEN</code>.</li>
            <li>If the system is in security lockdown, go to <a href="/ui/incident-room" class="text-daena-gold hover:underline">Incident Room</a> or <a href="/ui/founder-panel" class="text-daena-gold hover:underline">Founder Panel</a> to unlock.</li>
            <li>Check <a href="/ui/control-pannel#tasks-runbook-approvals" class="text-daena-gold hover:underline">Approvals Inbox</a> (Control Plane → Tasks & Runbook & Approvals) for pending execution requests that need approval.</li>
        </ul>
    </div>

    <div class="glass-panel p-6 rounded-xl">
        <h2 class="text-lg font-medium text-white mb-4">Quick links</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
            <a href="/ui/control-pannel#execution" class="flex items-center gap-3 p-3 rounded-lg bg-white/5 border border-white/10 hover:border-daena-gold/50 transition-colors text-white">
                <i class="fas fa-cogs text-daena-gold"></i>
                <span>Execution Layer (tools &amp; logs)</span>
            </a>
            <a href="/ui/control-pannel#tasks-runbook-approvals" class="flex items-center gap-3 p-3 rounded-lg bg-white/5 border border-white/10 hover:border-daena-gold/50 transition-colors text-white">
                <i class="fas fa-tasks text-daena-gold"></i>
                <span>Tasks (queue &amp; artifacts)</span>
            </a>
            <a href="/ui/incident-room" class="flex items-center gap-3 p-3 rounded-lg bg-white/5 border border-white/10 hover:border-daena-gold/50 transition-colors text-white">
                <i class="fas fa-shield-alt text-red-400"></i>
                <span>Incident Room (lockdown &amp; decoys)</span>
            </a>
            <a href="/ui/control-pannel#tasks-runbook-approvals" class="flex items-center gap-3 p-3 rounded-lg bg-white/5 border border-white/10 hover:border-daena-gold/50 transition-colors text-white">
                <i class="fas fa-inbox text-daena-gold"></i>
                <span>Approvals Inbox</span>
            </a>
            <a href="/ui/founder-panel" class="flex items-center gap-3 p-3 rounded-lg bg-white/5 border border-white/10 hover:border-daena-gold/50 transition-colors text-white">
                <i class="fas fa-user-shield text-daena-gold"></i>
                <span>Founder Panel</span>
            </a>
            <a href="/ui/control-pannel#app-setup" class="flex items-center gap-3 p-3 rounded-lg bg-white/5 border border-white/10 hover:border-daena-gold/50 transition-colors text-white">
                <i class="fas fa-sliders-h text-daena-gold"></i>
                <span>App Setup (Execution Token)</span>
            </a>
        </div>
    </div>
</div>
{% endblock %}
